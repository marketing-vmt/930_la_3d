<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, user-scalable=yes" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  <meta name="author" content="Kaif">
  <meta name="description" content="Interactive 3D viewer for Delta 930 La - Explore the product in 360° with zoom and rotation controls">
  <meta name="keywords" content="Delta 930 La, 3D viewer, product visualization, interactive">
  <title>Delta 930 La - Interactive 3D Viewer</title>

  <style>
    :root {
      --primary-color: #2563eb;
      --secondary-color: #1e40af;
      --accent-color: #3b82f6;
      --text-light: #ffffff;
      --text-dark: #1f2937;
      --bg-overlay: rgba(0, 0, 0, 0.7);
      --bg-glass: rgba(255, 255, 255, 0.1);
      --border-glass: rgba(255, 255, 255, 0.2);
      --shadow-soft: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
      --shadow-medium: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
      --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --transition-bounce: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      background: transparent;
      width: 100%;
      height: 100%;
      overflow: hidden;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      color: var(--text-light);
    }

    /* Loading Screen */
    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.5s ease, visibility 0.5s ease;
    }

    .loading-screen.hidden {
      opacity: 0;
      visibility: hidden;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid var(--border-glass);
      border-top: 4px solid var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 20px;
    }

    .loading-text {
      font-size: 18px;
      font-weight: 500;
      color: var(--text-light);
      opacity: 0.8;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Main Viewer Container */
    .viewer-container {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #KeyShotXR {
      display: block;
      background: transparent;
      border-radius: 12px;
      box-shadow: var(--shadow-medium);
      transition: var(--transition-smooth);
    }

    /* Floating Controls */
    .floating-controls {
      position: fixed;
      bottom: 30px;
      right: 30px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      z-index: 1000;
    }

    .zoom-controls {
      display: flex;
      flex-direction: column;
      gap: 8px;
      background: var(--bg-overlay);
      backdrop-filter: blur(10px);
      border: 1px solid var(--border-glass);
      border-radius: 16px;
      padding: 12px;
    }

    .zoom-btn {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      border: 2px solid white;
      background: rgba(0, 0, 0, 0.5);
      color: white;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: bold;
      user-select: none;
    }

    .zoom-btn:hover {
      background: rgba(255, 255, 255, 0.2);
      color: #ff4444;
      transform: scale(1.1);
    }

    .zoom-btn:active {
      transform: scale(0.95);
    }

    /* Error State */
    .error-state {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      background: var(--bg-overlay);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(239, 68, 68, 0.3);
      border-radius: 16px;
      padding: 40px;
      max-width: 400px;
      display: none;
    }

    .error-icon {
      font-size: 48px;
      color: #ef4444;
      margin-bottom: 16px;
    }

    .error-title {
      font-size: 20px;
      font-weight: 600;
      margin: 0 0 8px 0;
      color: var(--text-light);
    }

    .error-message {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.7);
      margin: 0 0 20px 0;
      line-height: 1.5;
    }

    .retry-btn {
      background: var(--primary-color);
      border: none;
      border-radius: 8px;
      padding: 12px 24px;
      color: var(--text-light);
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition-smooth);
    }

    .retry-btn:hover {
      background: var(--secondary-color);
    }

    /* Ultra-Responsive Design for All Screen Sizes */
    
    /* 8K TVs and Ultra-Wide Displays (3840px+) */
    @media (min-width: 3840px) {
      #KeyShotXR {
        width: min(60vh, 60vw);
        height: min(60vh, 60vw);
        max-width: 1200px;
        max-height: 1200px;
      }
      
      .floating-controls {
        bottom: 60px;
        right: 60px;
        gap: 20px;
      }
      
      .zoom-controls {
        padding: 20px;
        gap: 16px;
        border-radius: 24px;
      }
      
      .zoom-btn {
        width: 80px;
        height: 80px;
        font-size: 36px;
        border-radius: 50%;
        border: 2px solid white;
        background: rgba(0, 0, 0, 0.5);
        color: white;
      }
      
      .zoom-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        color: #ff4444;
        transform: scale(1.1);
      }
      
      .loading-spinner {
        width: 120px;
        height: 120px;
        border-width: 8px;
      }
      
      .loading-text {
        font-size: 32px;
      }
    }

    /* 4K TVs and Large Displays (2560px - 3839px) */
    @media (min-width: 2560px) and (max-width: 3839px) {
      #KeyShotXR {
        width: min(65vh, 65vw);
        height: min(65vh, 65vw);
        max-width: 1000px;
        max-height: 1000px;
      }
      
      .floating-controls {
        bottom: 50px;
        right: 50px;
        gap: 18px;
      }
      
      .zoom-controls {
        padding: 18px;
        gap: 14px;
        border-radius: 22px;
      }
      
      .zoom-btn {
        width: 70px;
        height: 70px;
        font-size: 32px;
        border-radius: 50%;
        border: 2px solid white;
        background: rgba(0, 0, 0, 0.5);
        color: white;
      }
      
      .zoom-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        color: #ff4444;
        transform: scale(1.1);
      }
      
      .loading-spinner {
        width: 100px;
        height: 100px;
        border-width: 6px;
      }
      
      .loading-text {
        font-size: 28px;
      }
    }

    /* Large Desktop/TV (1920px - 2559px) */
    @media (min-width: 1920px) and (max-width: 2559px) {
      #KeyShotXR {
        width: min(70vh, 70vw);
        height: min(70vh, 70vw);
        max-width: 900px;
        max-height: 900px;
      }
      
      .floating-controls {
        bottom: 40px;
        right: 40px;
        gap: 16px;
      }
      
      .zoom-controls {
        padding: 16px;
        gap: 12px;
        border-radius: 20px;
      }
      
      .zoom-btn {
        width: 60px;
        height: 60px;
        font-size: 28px;
        border-radius: 50%;
        border: 2px solid white;
        background: rgba(0, 0, 0, 0.5);
        color: white;
      }
      
      .zoom-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        color: #ff4444;
        transform: scale(1.1);
      }
      
      .loading-spinner {
        width: 80px;
        height: 80px;
        border-width: 5px;
      }
      
      .loading-text {
        font-size: 24px;
      }
    }

    /* Standard Desktop (1440px - 1919px) */
    @media (min-width: 1440px) and (max-width: 1919px) {
      #KeyShotXR {
        width: min(75vh, 75vw);
        height: min(75vh, 75vw);
        max-width: 800px;
        max-height: 800px;
      }
      
      .floating-controls {
        bottom: 35px;
        right: 35px;
        gap: 14px;
      }
      
      .zoom-controls {
        padding: 14px;
        gap: 10px;
        border-radius: 18px;
      }
      
      .zoom-btn {
        width: 54px;
        height: 54px;
        font-size: 24px;
        border-radius: 50%;
        border: 2px solid white;
        background: rgba(0, 0, 0, 0.5);
        color: white;
      }
      
      .zoom-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        color: #ff4444;
        transform: scale(1.1);
      }
    }

    /* Desktop (1200px - 1439px) */
    @media (min-width: 1200px) and (max-width: 1439px) {
      #KeyShotXR {
        width: min(80vh, 80vw);
        height: min(80vh, 80vw);
        max-width: 700px;
        max-height: 700px;
      }
      
      .floating-controls {
        bottom: 30px;
        right: 30px;
        gap: 12px;
      }
      
      .zoom-controls {
        padding: 12px;
        gap: 8px;
        border-radius: 16px;
      }
      
      .zoom-btn {
        width: 48px;
        height: 48px;
        font-size: 20px;
        border-radius: 50%;
        border: 2px solid white;
        background: rgba(0, 0, 0, 0.5);
        color: white;
      }
      
      .zoom-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        color: #ff4444;
        transform: scale(1.1);
      }
    }

    /* Laptop/Small Desktop (1024px - 1199px) */
    @media (min-width: 1024px) and (max-width: 1199px) {
      #KeyShotXR {
        width: min(82vh, 82vw);
        height: min(82vh, 82vw);
        max-width: 650px;
        max-height: 650px;
      }
      
      .floating-controls {
        bottom: 25px;
        right: 25px;
        gap: 10px;
      }
      
      .zoom-controls {
        padding: 10px;
        gap: 6px;
      }
      
      .zoom-btn {
        width: 44px;
        height: 44px;
        font-size: 18px;
        border-radius: 50%;
        border: 2px solid white;
        background: rgba(0, 0, 0, 0.5);
        color: white;
      }
      
      .zoom-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        color: #ff4444;
        transform: scale(1.1);
      }
    }

    /* Tablet Landscape (768px - 1023px) */
    @media (min-width: 768px) and (max-width: 1023px) {
      #KeyShotXR {
        width: min(85vh, 85vw);
        height: min(85vh, 85vw);
        max-width: 600px;
        max-height: 600px;
      }

      .floating-controls {
        bottom: 20px;
        right: 20px;
        gap: 8px;
      }
      
      .zoom-controls {
        padding: 8px;
        gap: 4px;
      }
      
      .zoom-btn {
        width: 40px;
        height: 40px;
        font-size: 16px;
        border-radius: 50%;
        border: 2px solid white;
        background: rgba(0, 0, 0, 0.5);
        color: white;
      }
      
      .zoom-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        color: #ff4444;
        transform: scale(1.1);
      }
    }

    /* Tablet Portrait (481px - 767px) */
    @media (min-width: 481px) and (max-width: 767px) {
      #KeyShotXR {
        width: 90vw;
        height: 90vw;
        max-width: 90vh;
        max-height: 90vh;
      }

      .floating-controls {
        bottom: 18px;
        right: 18px;
        gap: 6px;
      }
      
      .zoom-controls {
        padding: 6px;
        gap: 3px;
      }
      
      .zoom-btn {
        width: 38px;
        height: 38px;
        font-size: 15px;
        border-radius: 50%;
        border: 2px solid white;
        background: rgba(0, 0, 0, 0.5);
        color: white;
      }
      
      .zoom-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        color: #ff4444;
        transform: scale(1.1);
      }
    }

    /* Mobile Large (414px - 480px) */
    @media (min-width: 414px) and (max-width: 480px) {
      html, body {
        position: fixed;
        width: 100%;
        height: 100%;
      }

      #KeyShotXR {
        width: 92vw;
        height: 92vw;
        max-width: 92vh;
        max-height: 92vh;
      }

      .floating-controls {
        bottom: 15px;
        right: 15px;
        gap: 6px;
      }

      .zoom-controls {
        padding: 6px;
        gap: 3px;
      }

      .zoom-btn {
        width: 36px;
        height: 36px;
        font-size: 14px;
        border-radius: 50%;
        border: 2px solid white;
        background: rgba(0, 0, 0, 0.5);
        color: white;
      }
      
      .zoom-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        color: #ff4444;
        transform: scale(1.1);
      }
    }

    /* Mobile Standard (375px - 413px) */
    @media (min-width: 375px) and (max-width: 413px) {
      html, body {
        position: fixed;
        width: 100%;
        height: 100%;
      }

      #KeyShotXR {
        width: 94vw;
        height: 94vw;
        max-width: 94vh;
        max-height: 94vh;
      }

      .floating-controls {
        bottom: 12px;
        right: 12px;
        gap: 5px;
      }

      .zoom-controls {
        padding: 5px;
        gap: 2px;
      }

      .zoom-btn {
        width: 34px;
        height: 34px;
        font-size: 13px;
        border-radius: 50%;
        border: 2px solid white;
        background: rgba(0, 0, 0, 0.5);
        color: white;
      }
      
      .zoom-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        color: #ff4444;
        transform: scale(1.1);
      }
    }

    /* Mobile Small (320px - 374px) */
    @media (min-width: 320px) and (max-width: 374px) {
      html, body {
        position: fixed;
        width: 100%;
        height: 100%;
      }

      #KeyShotXR {
        width: 96vw;
        height: 96vw;
        max-width: 96vh;
        max-height: 96vh;
      }

      .floating-controls {
        bottom: 10px;
        right: 10px;
        gap: 4px;
      }

      .zoom-controls {
        padding: 4px;
        gap: 2px;
      }

      .zoom-btn {
        width: 32px;
        height: 32px;
        font-size: 12px;
        border-radius: 50%;
        border: 2px solid white;
        background: rgba(0, 0, 0, 0.5);
        color: white;
      }
      
      .zoom-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        color: #ff4444;
        transform: scale(1.1);
      }
    }

    /* Ultra-Small Devices (below 320px) */
    @media (max-width: 319px) {
      html, body {
        position: fixed;
        width: 100%;
        height: 100%;
      }

      #KeyShotXR {
        width: 98vw;
        height: 98vw;
        max-width: 98vh;
        max-height: 98vh;
      }

      .floating-controls {
        bottom: 8px;
        right: 8px;
        gap: 3px;
      }

      .zoom-controls {
        padding: 3px;
        gap: 1px;
      }

      .zoom-btn {
        width: 28px;
        height: 28px;
        font-size: 11px;
        border-radius: 50%;
        border: 2px solid white;
        background: rgba(0, 0, 0, 0.5);
        color: white;
      }
      
      .zoom-btn:hover {
        background: rgba(255, 255, 255, 0.2);
        color: #ff4444;
        transform: scale(1.1);
      }
    }

    /* Landscape Orientation Adjustments */
    @media (orientation: landscape) and (max-width: 1023px) {
      #KeyShotXR {
        width: min(85vh, 85vw);
        height: min(85vh, 85vw);
      }

      .floating-controls {
        bottom: 10px;
        right: 15px;
      }
    }

    /* Ultra-wide screens (aspect ratio > 2:1) */
    @media (min-aspect-ratio: 2/1) {
      #KeyShotXR {
        width: min(80vh, 40vw);
        height: min(80vh, 40vw);
      }
    }

    /* Very tall screens (aspect ratio < 1:2) */
    @media (max-aspect-ratio: 1/2) {
      #KeyShotXR {
        width: min(40vh, 80vw);
        height: min(40vh, 80vw);
      }
    }

    /* High DPI Displays */
    @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
      .zoom-btn {
        border-width: 0.5px;
      }
    }

    /* Accessibility */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }

    /* Focus styles for keyboard navigation */
    .zoom-btn:focus,
    .retry-btn:focus {
      outline: 2px solid var(--primary-color);
      outline-offset: 2px;
    }

    /* Print styles */
    @media print {
      .floating-controls {
        display: none;
      }
      
      body {
        background: white;
      }
    }

    /* Dark mode support */
    @media (prefers-color-scheme: dark) {
      :root {
        --bg-overlay: rgba(0, 0, 0, 0.8);
        --bg-glass: rgba(255, 255, 255, 0.05);
        --border-glass: rgba(255, 255, 255, 0.1);
      }
    }

    /* Light mode support */
    @media (prefers-color-scheme: light) {
      :root {
        --bg-overlay: rgba(255, 255, 255, 0.9);
        --bg-glass: rgba(0, 0, 0, 0.05);
        --border-glass: rgba(0, 0, 0, 0.1);
        --text-light: #1f2937;
      }
    }
  </style>

  <script type="text/javascript" src="Delta 930 kaif.147/files/KeyShotXR.js"></script>
  <script type="text/javascript">
    var keyshotXR;
    var currentZoom = 1;

    // Screen size detection and adaptive zoom calculation
    function getScreenCategory() {
      const width = window.innerWidth;
      const height = window.innerHeight;
      const diagonal = Math.sqrt(width * width + height * height);
      
      if (width >= 3840) return 'ultra-large'; // 8K TVs
      if (width >= 2560) return 'large-tv';    // 4K TVs
      if (width >= 1920) return 'tv';          // Large displays/TVs
      if (width >= 1440) return 'desktop';     // Standard desktop
      if (width >= 1200) return 'laptop';      // Laptop
      if (width >= 1024) return 'small-laptop'; // Small laptop
      if (width >= 768) return 'tablet-landscape'; // Tablet landscape
      if (width >= 481) return 'tablet-portrait';  // Tablet portrait
      if (width >= 414) return 'mobile-large';     // Large mobile
      if (width >= 375) return 'mobile-standard';  // Standard mobile
      if (width >= 320) return 'mobile-small';     // Small mobile
      return 'ultra-small'; // Ultra-small devices
    }

    function getAdaptiveZoom() {
      const category = getScreenCategory();
      const zoomMap = {
        'ultra-large': 0.8,    // Lower zoom for huge screens
        'large-tv': 1.0,       // Moderate zoom for 4K TVs
        'tv': 1.2,             // Slightly higher for large displays
        'desktop': 1.5,        // Standard zoom for desktop
        'laptop': 1.8,         // Higher zoom for laptops
        'small-laptop': 2.0,   // Even higher for small laptops
        'tablet-landscape': 2.2, // Higher zoom for tablets
        'tablet-portrait': 2.5,  // Higher zoom for portrait tablets
        'mobile-large': 2.8,     // High zoom for large mobiles
        'mobile-standard': 3.0,  // Higher zoom for standard mobiles
        'mobile-small': 3.2,     // Very high zoom for small mobiles
        'ultra-small': 3.5       // Maximum zoom for tiny screens
      };
      return zoomMap[category] || 1.5;
    }

    function getAdaptiveSensitivity() {
      const category = getScreenCategory();
      const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || 
                       (navigator.maxTouchPoints && navigator.maxTouchPoints > 2);
      
      if (isMobile) {
        // Mobile sensitivity based on screen size
        const sensitivityMap = {
          'mobile-large': { u: -0.06, v: 0.12 },
          'mobile-standard': { u: -0.08, v: 0.15 },
          'mobile-small': { u: -0.10, v: 0.18 },
          'ultra-small': { u: -0.12, v: 0.20 },
          'tablet-portrait': { u: -0.05, v: 0.10 },
          'tablet-landscape': { u: -0.04, v: 0.08 }
        };
        return sensitivityMap[category] || { u: -0.08, v: 0.15 };
      } else {
        // Desktop sensitivity based on screen size
        const sensitivityMap = {
          'ultra-large': { u: -0.02, v: 0.04 },
          'large-tv': { u: -0.03, v: 0.06 },
          'tv': { u: -0.04, v: 0.08 },
          'desktop': { u: -0.055, v: 0.125 },
          'laptop': { u: -0.06, v: 0.14 },
          'small-laptop': { u: -0.07, v: 0.16 }
        };
        return sensitivityMap[category] || { u: -0.055, v: 0.125 };
      }
    }

    // Initialize KeyShotXR with adaptive settings
    function initKeyShotXR() {
      const nameOfDiv = "KeyShotXR";
      const folderName = "Delta 930 kaif.147";

      // Calculate optimal viewer size based on screen category
      const screenWidth = window.innerWidth;
      const screenHeight = window.innerHeight;
      const category = getScreenCategory();
      
      let viewerSize;
      switch(category) {
        case 'ultra-large':
          viewerSize = Math.min(screenWidth * 0.6, screenHeight * 0.6, 1200);
          break;
        case 'large-tv':
          viewerSize = Math.min(screenWidth * 0.65, screenHeight * 0.65, 1000);
          break;
        case 'tv':
          viewerSize = Math.min(screenWidth * 0.7, screenHeight * 0.7, 900);
          break;
        case 'desktop':
          viewerSize = Math.min(screenWidth * 0.75, screenHeight * 0.75, 800);
          break;
        case 'laptop':
          viewerSize = Math.min(screenWidth * 0.8, screenHeight * 0.8, 700);
          break;
        case 'small-laptop':
          viewerSize = Math.min(screenWidth * 0.82, screenHeight * 0.82, 650);
          break;
        case 'tablet-landscape':
          viewerSize = Math.min(screenWidth * 0.85, screenHeight * 0.85, 600);
          break;
        case 'tablet-portrait':
          viewerSize = Math.min(screenWidth * 0.9, screenHeight * 0.9);
          break;
        case 'mobile-large':
          viewerSize = Math.min(screenWidth * 0.92, screenHeight * 0.92);
          break;
        case 'mobile-standard':
          viewerSize = Math.min(screenWidth * 0.94, screenHeight * 0.94);
          break;
        case 'mobile-small':
          viewerSize = Math.min(screenWidth * 0.96, screenHeight * 0.96);
          break;
        default:
          viewerSize = Math.min(screenWidth * 0.98, screenHeight * 0.98);
      }

      const viewPortWidth = viewerSize;
      const viewPortHeight = viewerSize;
      const backgroundColor = "transparent";
      const uCount = 20;
      const vCount = 20;
      const uWrap = true;
      const vWrap = false;

      // Get adaptive sensitivity
      const sensitivity = getAdaptiveSensitivity();
      const uMouseSensitivity = sensitivity.u;
      const vMouseSensitivity = sensitivity.v;

      const uStartIndex = 8;
      const vStartIndex = 10;
      const minZoom = 0.2;
      const maxZoom = 8;
      const rotationDamping = 0.96;
      const downScaleToBrowser = false;
      const addDownScaleGUIButton = false;
      const downloadOnInteraction = false;
      const imageExtension = "webp";
      const showLoading = false; // We handle loading ourselves
      const loadingIcon = "ba.png";
      const allowFullscreen = true;
      const uReverse = false;
      const vReverse = false;
      const hotspots = {};
      const isIBooksWidget = false;

      try {
        keyshotXR = new keyshotXR(
          nameOfDiv,
          folderName,
          viewPortWidth,
          viewPortHeight,
          backgroundColor,
          uCount,
          vCount,
          uWrap,
          vWrap,
          uMouseSensitivity,
          vMouseSensitivity,
          uStartIndex,
          vStartIndex,
          minZoom,
          maxZoom,
          rotationDamping,
          downScaleToBrowser,
          addDownScaleGUIButton,
          downloadOnInteraction,
          imageExtension,
          showLoading,
          loadingIcon,
          allowFullscreen,
          uReverse,
          vReverse,
          hotspots,
          isIBooksWidget
        );

        // Set adaptive initial zoom and hide loading screen
        setTimeout(() => {
          if (keyshotXR && typeof keyshotXR.T === 'function') {
            const adaptiveZoom = getAdaptiveZoom();
            keyshotXR.T(adaptiveZoom);
            currentZoom = adaptiveZoom;
            hideLoadingScreen();
            console.log(`KeyShotXR initialized successfully for ${category} with zoom ${adaptiveZoom}`);
          } else {
            console.log('KeyshotXR T method not ready, retrying...');
            setTimeout(() => {
              if (keyshotXR && typeof keyshotXR.T === 'function') {
                const adaptiveZoom = getAdaptiveZoom();
                keyshotXR.T(adaptiveZoom);
                currentZoom = adaptiveZoom;
                hideLoadingScreen();
              } else {
                showErrorState();
              }
            }, 500);
          }
        }, 200);

      } catch (error) {
        console.error('KeyShotXR initialization error:', error);
        showErrorState();
      }
    }

    // UI Control Functions
    function hideLoadingScreen() {
      const loadingScreen = document.querySelector('.loading-screen');
      if (loadingScreen) {
        loadingScreen.classList.add('hidden');
        setTimeout(() => {
          loadingScreen.style.display = 'none';
        }, 500);
      }
    }

    function showErrorState() {
      hideLoadingScreen();
      const errorState = document.querySelector('.error-state');
      if (errorState) {
        errorState.style.display = 'block';
      }
    }

    function zoomIn() {
      if (keyshotXR && typeof keyshotXR.T === 'function') {
        const category = getScreenCategory();
        const zoomStep = category.includes('mobile') || category.includes('tablet') ? 1.15 : 1.2;
        currentZoom = Math.min(currentZoom * zoomStep, 8);
        keyshotXR.T(currentZoom);
      }
    }

    function zoomOut() {
      if (keyshotXR && typeof keyshotXR.T === 'function') {
        const category = getScreenCategory();
        const zoomStep = category.includes('mobile') || category.includes('tablet') ? 1.15 : 1.2;
        currentZoom = Math.max(currentZoom / zoomStep, 0.2);
        keyshotXR.T(currentZoom);
      }
    }

    function resetView() {
      if (keyshotXR && typeof keyshotXR.T === 'function') {
        const adaptiveZoom = getAdaptiveZoom();
        currentZoom = adaptiveZoom;
        keyshotXR.T(currentZoom);
        // Reset rotation if method exists
        if (typeof keyshotXR.reset === 'function') {
          keyshotXR.reset();
        }
      }
    }

    function retryLoad() {
      location.reload();
    }

    // Event Listeners
    window.addEventListener("load", () => {
      initKeyShotXR();
    });

    window.addEventListener("resize", debounce(() => {
      if (keyshotXR && typeof keyshotXR.resize === 'function') {
        keyshotXR.resize();
        // Readjust zoom for new screen size
        setTimeout(() => {
          const adaptiveZoom = getAdaptiveZoom();
          if (keyshotXR && typeof keyshotXR.T === 'function') {
            keyshotXR.T(adaptiveZoom);
            currentZoom = adaptiveZoom;
          }
        }, 100);
      }
    }, 250));

    window.addEventListener("orientationchange", () => {
      setTimeout(() => {
        if (keyshotXR && typeof keyshotXR.resize === 'function') {
          keyshotXR.resize();
          // Readjust zoom for new orientation
          setTimeout(() => {
            const adaptiveZoom = getAdaptiveZoom();
            if (keyshotXR && typeof keyshotXR.T === 'function') {
              keyshotXR.T(adaptiveZoom);
              currentZoom = adaptiveZoom;
            }
          }, 200);
        }
      }, 100);
    });

    // Keyboard navigation
    document.addEventListener("keydown", (e) => {
      switch(e.key) {
        case '+':
        case '=':
          e.preventDefault();
          zoomIn();
          break;
        case '-':
          e.preventDefault();
          zoomOut();
          break;
        case 'r':
        case 'R':
          resetView();
          break;
      }
    });

    // Prevent context menu and handle multi-touch
    document.addEventListener("contextmenu", e => e.preventDefault());
    document.addEventListener("touchstart", e => { 
      if (e.touches.length > 1) e.preventDefault(); 
    }, { passive: false });
    document.addEventListener("touchmove", e => { 
      if (e.touches.length > 1) e.preventDefault(); 
    }, { passive: false });

    // Utility function for debouncing
    function debounce(func, wait) {
      let timeout;
      return function executedFunction(...args) {
        const later = () => {
          clearTimeout(timeout);
          func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
      };
    }

    // Performance monitoring
    window.addEventListener('load', () => {
      if ('performance' in window) {
        const loadTime = performance.timing.loadEventEnd - performance.timing.navigationStart;
        console.log('Page load time:', loadTime + 'ms');
      }
      
      // Log screen information
      console.log(`Screen: ${window.innerWidth}x${window.innerHeight}, Category: ${getScreenCategory()}, Adaptive Zoom: ${getAdaptiveZoom()}`);
    });
  </script>
</head>
<body>
  <!-- Loading Screen -->
  <div class="loading-screen">
    <div class="loading-spinner"></div>
    <div class="loading-text">Loading 3D Viewer...</div>
  </div>

  <!-- Main Viewer -->
  <div class="viewer-container">
    <div id="KeyShotXR" role="img" aria-label="Interactive 3D model of Delta 930 La"></div>
    
    <!-- Error State -->
    <div class="error-state">
      <div class="error-icon">⚠️</div>
      <h2 class="error-title">Failed to Load 3D Viewer</h2>
      <p class="error-message">The 3D model could not be loaded. Please check your internet connection and try again.</p>
      <button class="retry-btn" onclick="retryLoad()">Retry</button>
    </div>
  </div>

  <!-- Floating Controls -->
  <div class="floating-controls">
    <div class="zoom-controls">
      <button class="zoom-btn" onclick="zoomIn()" title="Zoom In (+)" aria-label="Zoom in">+</button>
      <button class="zoom-btn" onclick="resetView()" title="Reset View (R)" aria-label="Reset view">⌂</button>
      <button class="zoom-btn" onclick="zoomOut()" title="Zoom Out (-)" aria-label="Zoom out">−</button>
    </div>
  </div>
</body>
</html>

